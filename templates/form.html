<!DOCTYPE html>
<html>
<head>
    <title>Manage Persons</title>
</head>
<body>
    <h1>Manage Persons</h1>

    <form method="post" onsubmit="addPerson(event)">
        <label for="first_name">First Name:</label>
        <input type="text" name="first_name" id="first_name" required><br>
        <label for="last_name">Last Name:</label>
        <input type="text" name="last_name" id="last_name" required><br>
        <label for="age">Age:</label>
        <input type="number" name="age" id="age" required><br>
        <button type="submit">Add Person</button>
    </form>

    <h2>All Persons:</h2>
    <ul id="person_list"></ul>

    <script>
        function addPerson(event) {
            event.preventDefault();
            const first_name = document.getElementById("first_name").value;
            const last_name = document.getElementById("last_name").value;
            const age = parseInt(document.getElementById("age").value);

            const data = {
                "first_name": first_name,
                "last_name": last_name,
                "age": age
            };

            fetch("/add_person/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(() => listPersons());
        }

        function listPersons() {
            fetch("/list_persons/")
            .then(response => response.json())
            .then(data => {
                const personList = document.getElementById("person_list");
                personList.innerHTML = "";
                data.forEach(person => {
                    const li = document.createElement("li");
                    li.innerText = `${person.first_name} ${person.last_name}, Age: ${person.age}`;
                    personList.appendChild(li);
                });
            });
        }
        
        // Initial list of persons
        listPersons();
    </script>
</body>
</html>
